# Devlog: 2025-11-04

## Focus

Architecture evolution: 3 layers → 4 layers with learn-then-abstract approach.

## Key Insight

Can't design good abstraction (M2-VFS) without understanding concrete case (M1-CLAUDE). Inserting claude-native layer makes this explicit.

## Architecture Change

**Old:** M1 (API) → M2 (Cache) → M3 (CLI)

**New:** M1-CLAUDE (native) → M2-VFS (normalized) → M3-CACHE (persistence) → M4-CLI (UX)

M1-CLAUDE outputs whatever Claude returns (no normalization decisions). M2-VFS designs normalization based on M1-CLAUDE findings.

## Other Decisions

- **Fork representation:** Split into 3 phases across M1/M2/M3 milestones (was conflating distinct questions)
- **Provider abstraction:** New design incubator, depends on M1-CLAUDE findings

## Commits

- docs: evolve architecture from 3 to 4 layers with phased milestones
- docs: Phase 1.25 Step 1 - evolve architecture to 4 layers
- docs: Phase 1.25 complete - milestone renaming and M1-CLAUDE references
- docs: update devlog for 2025-11-04 session 2
- docs: Phase 1.4 complete - integrate open questions understanding

## Sessions

**Session 1:** Phase 1.25 Step 1 - updated core architecture docs with 4-layer spec

**Session 2:** Phase 1.25 Steps 2-3 complete:
- Step 2: Renamed all milestone references (worked backwards M3→M2→M1→M0 to avoid overwrites)
- Step 3: Added M1-CLAUDE quick reference examples to CLAUDE.md, updated README.md architecture overview
- Phase 1.4: Integrated open questions understanding into design-incubators/

**Session 2 details - Phase 1.4:**
- Updated fork-representation incubator with 3-phase structure across milestones
- Created api-investigation.md template for M1-CLAUDE Phase 1 work
- Created new provider-abstraction incubator for M2-VFS abstraction design
- Updated design-incubators/README.md with multi-phase incubators guideline
- Deleted open-questions-revision-notes.md (fully integrated)

## Next Session

Phase 1.5: Terminology Cleanup (plumbing/porcelain → layer structure) - major refactor.

## Links

- [../../../TODO.md] - Phase 1.25 tracking
- [2025-11-02.md] - Previous session
